![](https://img.shields.io/badge/Python-3.7.0-blue) 
![](https://img.shields.io/badge/Django-2.2.16-orange)
![](https://img.shields.io/badge/DjangoRestFramework-3.12.4-red)
</br>
### Описание проекта

Проект представляет API для проекта YaMDb.
Проект YaMDb собирает отзывы пользователей на произведения. Сами произведения в YaMDb не хранятся.
По адресу http://127.0.0.1:8000/redoc/ к нему подключена документация.

### Способы реализации проекта:

Проект реализован на фреймворке Django.

Примененение вьюсетов.

### Пользовательские роли и права доступа

Аноним — может просматривать описания произведений, читать отзывы и комментарии.

Аутентифицированный пользователь (user) — может читать всё, как и Аноним, может публиковать отзывы и ставить оценки произведениям (фильмам/книгам/песенкам), может комментировать отзывы; может редактировать и удалять свои отзывы и комментарии, редактировать свои оценки произведений. Эта роль присваивается по умолчанию каждому новому пользователю.

Модератор (moderator) — те же права, что и у Аутентифицированного пользователя, плюс право удалять и редактировать любые отзывы и комментарии.

Администратор (admin) — полные права на управление всем контентом проекта. Может создавать и удалять произведения, категории и жанры. Может назначать роли пользователям.

Суперюзер Django должен всегда обладать правами администратора, пользователя с правами admin. Даже если изменить пользовательскую роль суперюзера — это не лишит его прав администратора. Суперюзер — всегда администратор, но администратор — не обязательно суперюзер.

Аутентифицированным пользователям разрешено оставлять к произведениям текстовые отзывы и ставят произведению оценку в диапазоне от одного до десяти (целое число); из пользовательских оценок формируется усреднённая оценка произведения — рейтинг (целое число). На одно произведение пользователь может оставить только один отзыв. Пользователи могут оставлять комментарии к отзывам.

Добавлять отзывы, комментарии и ставить оценки могут только аутентифицированные пользователи.

Добавлять произведения, категории и жанры может только администратор.

### Установка

## 1) Склонировать репозиторий
`git@github.com:Yandexpract/api_yamdb.git`

## 2) Создать виртуальное окружение для проекта
`python -m venv venv`


## 3) Активировать виртуальное окружение для проекта
`. venv/Scripts/activate`

## 4) Установить зависимости
`pip install -r requirements.txt`

## 5) Выполнить миграции
`python manage.py migrate`

## 5) Запустить сервер
`python manage.py runserver`

### Примеры

Пользователей создаёт администратор — через админ-зону сайта или через POST-запрос на специальный эндпоинт
 'api/v1/users/' (описание полей запроса для этого случая есть в документации). При создании пользователя не предполагается автоматическая отправка письма пользователю с кодом подтверждения. 
После этого пользователь должен самостоятельно отправить свой email и username на эндпоинт '/api/v1/auth/signup/' , в ответ ему должно прийти письмо с кодом подтверждения.
Далее пользователь отправляет POST-запрос с параметрами username и confirmation_code на эндпоинт /api/v1/auth/token/, в ответе на заппрос ему приходит token (JWT-токен), как и при самостоятельной регистрации.

### Как импортировать данные из csv-файлов в базу данных


С помощью management-команд. Для того, чтобы загрузить все данные, из корневой директории проекта выполните команду:

```
python3 manage.py load_data
```
Все данные хранятся в каталоге api_yamdb/static/data

Файлы необходимые для загрузки:
* users.csv
* genre.csv
* category.csv
* titles.csv
* genre_title.csv
* review.csv
* comments.csv

----
### Процедура регистрации:

Получение кода подтверждения на переданный email:
```
POST http://127.0.0.1:8000/api/v1/auth/signup/
```

```
{
"email": "ваш email",
"username": "ваш username"
}
```
Получение JWT-токена в обмен на username и confirmation code из письма:
```
POST http://127.0.0.1:8000/api/v1/auth/token/
```

```
{
"username": "ваш username",
"confirmation_code": "confirmation code из письма"
}
```
Далее токен необходимо передавать в заголовке каждого запроса, в поле Authorization. Перед самим токеном должно стоять ключевое слово Bearer и пробел:
```
Bearer <токен>
```
<br>

### Примеры запросов:

Получение списка всех произведений:
```
GET http://127.0.0.1:8000/api/v1/titles/
```

```
{
    "count": 2,
    "next": null,
    "previous": null,
    "results": [
        {
            "id": 1,
            "category": {
                "name": "Музыка",
                "slug": "music"
            },
            "genre": [
                {
                    "name": "Поп-рок",
                    "slug": "pop-rock"
                }
            ],
            "rating": 6,
            "name": "A-Ha - Lifelines",
            "year": 2002,
            "description": "Песня"
        },
        {
            "id": 2,
            "category": {
                "name": "Фильмы",
                "slug": "films"
            },
            "genre": [
                {
                    "name": "Мыло",
                    "slug": "soap"
                }
            ],
            "rating": 4,
            "name": "Санта Барбара",
            "year": 1984,
            "description": ""
        }
    ]
}
```
Полуение отзыва по id:
```
GET http://127.0.0.1:8000/api/v1/titles/1/reviews/4/
```

```
{
    "id": 3,
    "author": "leo",
    "text": "Потянет",
    "score": 5,
    "pub_date": "2022-06-17T10:44:44.562182Z"
}
```
Добавление комментария к отзыву:
```
POST http://127.0.0.1:8000/api/v1/titles/1/reviews/4/comments/
```

```
{
"text": "Не могу не согласиться"
}
```
<br>
### Создатели

1.Александр Зубарев: Тимлид.Отзывы, комментарии, рейтинг произведений.
2.Михаил Пономарёв: Регистрация и авторизация, управление пользователями, права доступа.
3.Андрей Федин: Произведения, категории, жанры, импорт csv-файлов.
